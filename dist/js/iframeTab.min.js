!function(){iframeTab=jQuery.prototype={iframeHeight:function(e){var a=$(".active iframe")[0],t=$(document).frames?$(document).frames.iframepage.document:a.contentDocument;e?a.height=e:null!=a&&null!=t&&(a.height=t.body.scrollHeight)},init:function(option){function stellung(e){function a(e){var a,t,i,c=r.width();return i=e.beforeCreat(),i!==!1&&(l.removeClass("active"),r.append('<li class="active '+tabLiClass+'" data-tab="'+n+'" data-name="'+o+'" data-num="'+tnum+'">'+o+'<i class="'+closesBtnClass+'" data-btn="close"></i></li>'),!$('.tabs-header [data-btn="switch"]').length&&r.height()>singleLineheight?(a=r.find("li:last-child"),r.width(c-30),r.addClass("hide-tab"),r.after('<i class="'+switchBtnDown+' fold-switch" data-btn="switch"></i>'),$(document).on("click.iframetab.switch",'.tabs-header [data-btn="switch"]',function(){var e=$(this);e.toggleClass(switchBtnDown),e.toggleClass(switchBtnUp),r.toggleClass("hide-tab")}),a.remove(),r.find("li:first-child").before(a)):$('.tabs-header [data-btn="switch"]').length&&(t=r.find("li:last-child"),t.remove(),r.find("li:first-child").before(t)),d.removeClass("active"),s.append(b),b.wrap('<div class="tab-panel active '+tabPanClass+'"></div>'),b.wrap(iframeBox),e.onCreat(),$(b).load(function(){e.afterCreat()}),void(tnum+=1))}var t=$(this),n=t.attr("href"),o=t.attr("data-name")?t.data("name"):t.text(),i=t.data("mul"),c=t.data("reload"),r=$(".tabs-header ul",p),l=$(".tabs-header li",p),s=$(".tabs-body",p),d=$(".tab-panel",p),f=r.find('li[data-name="'+o+'"]').data("tab"),b=$('<iframe src="'+n+'" data-iframe="'+n+'" data-num="'+tnum+'" marginheight="0" marginwidth="0" frameborder="0" scrolling="no" onLoad="iframeTab.iframeHeight()" name="'+tnum+'"></iframe>');if(t.on("click",function(e){e.preventDefault(),e.stopPropagation()}),1===e.which){var m={beforeCreat:function(){if(callback.beforeCreat)return callback.beforeCreat()},onCreat:function(){callback.onCreat&&callback.onCreat()},afterCreat:function(){callback.afterCreat&&callback.afterCreat()}};$('.tabs-header li[data-name="'+o+'"]',p).length>0&&"undefined"==typeof i?!$('.tabs-header li[data-tab="'+n+'"]',p).length>0?(r.find('li[data-name="'+o+'"]').remove(),s.find('iframe[data-iframe="'+f+'"]').remove(),a(m)):(l.removeClass("active"),r.find('li[data-tab="'+n+'"]').addClass("active"),d.removeClass("active"),s.find('iframe[data-iframe="'+n+'"]').parents(".tab-panel").addClass("active"),c&&s.find('iframe[data-iframe="'+n+'"]').attr("src",n)):a(m)}}function btnDel(e){$(document).on("click.iframetab",'.tabs-header li [data-btn="close"]',function(a){var t,n=$(this),o=n.parent(),i=o.data("tab"),c=o.data("num"),r=$(".tabs-header ul"),l=$(".tabs-header li"),s=$(".tabs-body"),d=o.prev(),f=o.next(),b=$(window).width(),m=0;return t=e.beforeClose(),t!==!1&&(o.remove(),s.find('iframe[data-iframe="'+i+'"][data-num="'+c+'"]').parents(".tab-panel").remove(),l.each(function(){var e=$(this),a=e.width()>0?e.width()+25:e.width();m+=a}),$('.tabs-header [data-btn="switch"]').length&&m<b-menuWidth&&($(".tabs-header").find('[data-btn="switch"]').remove(),$(document).off("click.iframetab.switch"),r.toggleClass("hide-tab"),r.width("auto")),e.onClose(),"undefined"==typeof d.html()?f.click():d.click(),a.preventDefault(),a.stopPropagation(),void e.afterClose())})}function changeTab(e){$(document).on("click.iframetab",".tabs-header li:not(.active)",function(){var a,t=$(this),n=t.data("tab"),o=t.data("num"),i=$(".tabs-header ul"),c=$(".tabs-header li"),r=$(".tabs-body"),l=$(".tab-panel"),s=r.find('iframe[data-iframe="'+n+'"][data-num="'+o+'"]');return a=e.beforeChange(),a!==!1&&(c.removeClass("active"),l.removeClass("active"),e.onChange(),i.find('li[data-tab="'+n+'"][data-num="'+o+'"]').addClass("active"),s.parents(".tab-panel").addClass("active"),void e.afterChange())})}function creatContextmenu(e){var a=$(this),t=e.clientX,n=e.clientY,o=window.innerWidth,i='<div class="tab-contextmenu '+contextmenuClass+'" style="top: '+n+'px"><ul class="dropdown-menu"><li><a href="javascript: void(0)" data-btn="removeAll">关闭所有标签</a></li><li><a href="javascript: void(0)" data-btn="removeExceptAct">关闭激活标签外所有标签</a></li></ul></div>',c=180;3===e.which&&(a.on("contextmenu",function(e){e.preventDefault()}),$(".tab-contextmenu").length&&$(".tab-contextmenu").remove(),$("body").before(i),o-t>c?$(".tab-contextmenu").css("left",t):$(".tab-contextmenu").css("right",c),$(document).on("click.context.remove.pl",'[data-btn="removeAll"]',function(){$(".tabs-header li:not(.tab-keep)").remove(),$(".tab-panel:not(.tab-keep)").remove(),$(".tabs-header li.tab-keep").click()}),$(document).on("click.context.remove.sing",'[data-btn="removeExceptAct"]',function(){$(".tabs-header li, .tab-panel").each(function(){var e=$(this);e.is(":not(.tab-keep)")&&e.is(":not(.active)")&&e.remove()}),$(".tabs-header li.active").click()}),$("body").on("click.hide.context",function(){$("body").off("click.hide.context"),$(".tab-contextmenu").remove(),$(document).off("click.context.remove.pl",'[data-btn="removeAll"]').off("click.context.remove.sing",'[data-btn="removeExceptAct"]')}),$(".tab-panel.active iframe")[0].contentWindow.$("body").on("click.hide.context",function(){$(".tab-panel.active iframe")[0].contentWindow.$("body").off("click.hide.context"),parent.$(".tab-contextmenu").remove(),parent.$(document).off("click.context.remove.pl",'[data-btn="removeAll"]').off("click.context.remove.sing",'[data-btn="removeExceptAct"]')}))}function offEvents(){$(document).off("mouseup.iframetab").off("click.iframetab"),$(".tabs-header").off("mousedown.iframetab")}function testArry(e){return Array.isArray(e)?"array":typeof e}var _tab=this,tab=_tab.prototype,tnum=0,p=window.parent.document,options=$.extend({tabLiClass:"",tabPanClass:"",closesBtnClass:"fa fa-close",switchBtnDown:"fa fa-chevron-down",switchBtnUp:"fa fa-chevron-up",contextmenuClass:"dropdown open",iframeBox:'<div class="right_col" role="main"></div>',singleLineheight:92,menuWidth:230,callback:[]},option),tabLiClass=options.tabLiClass,tabPanClass=options.tabPanClass,closesBtnClass=options.closesBtnClass,switchBtnDown=options.switchBtnDown,switchBtnUp=options.switchBtnUp,iframeBox=options.iframeBox,singleLineheight=options.singleLineheight,menuWidth=options.menuWidth,contextmenuClass=options.contextmenuClass,callback=options.callback;if($(document).on("mouseup.iframetab","a[data-num]",stellung),1===$(".tabs-header li",p).length){var changeCb={beforeChange:function(){if(callback.beforeChange)return callback.beforeChange()},onChange:function(){callback.onChange&&callback.onChange()},afterChange:function(){callback.afterChange&&callback.afterChange()}},closeCb={beforeClose:function(){if(callback.beforeClose)return callback.beforeClose()},onClose:function(){callback.onClose&&callback.onClose()},afterClose:function(){callback.afterClose&&callback.afterClose()}};changeTab(changeCb),btnDel(closeCb)}return $(".tabs-header").on("mousedown.iframetab",creatContextmenu),$("[data-source]").length&&$(document).on("mouseup.iframetab","[data-source]",function(){var e=$(this),a=e.data("source"),t=$(".tabs-body",p);t.find('iframe[src="'+a+'"]').attr("src",a),iframeTab.iframeHeight()}),$('[data-btn="refresh"]').length&&$(document).on("click.iframetab",'[data-btn="refresh"]',function(e){e.preventDefault(),e.stopPropagation(),window.location.reload(!0)}),tab={on:function(e,a){var t,n,o,i=e,c=testArry(i);switch(c){case"string":for(t=i.split(" "),n=0;n<t.length;n++)o=t[n],callback[o]=a;break;case"object":for(n in i)callback[n]=i[n];break;default:console.error("Event type is unexceptable.")}},off:function(e){var a,t,n,o=e,i=typeof o;switch(i){case"string":for(a=o.split(" "),t=0;t<a.length;t++)n=a[t],delete callback[n];break;case"undefined":for(t in callback)delete callback[t]}},closeActIframe:function(){parent.$('.tabs-header li.active [data-btn="close"]').click()},destroy:function(){var e;offEvents();for(e in tab)"dispose"!==e&&delete tab[e]},dispose:function(refName){offEvents(),eval(refName+" = null;"),eval("delete "+refName+";")}}}}}();